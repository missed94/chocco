(function() {
  function carousel(arrowRight, arrowLeft, moove, carouselContent) {

    let countChildrenElement = $(carouselContent).children('.slider-content-item').length;
  
  
    arrowRight.on("click", function () {
      moove -= 100;
  
      if (moove < -((countChildrenElement - 1) * 100)) {
        moove = 0;
      }
  
      return carouselContent.css("left", (moove + "%"));
    });
  
    arrowLeft.on("click", function () {
      moove += 100;
  
      if (moove > 0) {
        moove = -((countChildrenElement - 1) * 100);
        }
      
  
      return carouselContent.css("left", (moove + "%"));
    });
  
    
  }
  
  carousel(
    $(".slider_arrow-right-wrapper"),
    $(".slider__arrow-left-wrapper"),
    0,
    $(".slider-content-list")
  ); 
  
  
  /* const arrowLeft = document.querySelector(".slider__arrow-left-wrapper");
  const arrowRight = document.querySelector(".slider_arrow-right-wrapper");
  const carouselContent = document.querySelector(".slider-content-list");
  const carouselItem = document.querySelectorAll(".slider-content-item")
  
  let moove = 0;
  
  
  
  function carousel(arrowLeft, arrowRight, carouselContent, moove) {
  
  let countChildrenElement = $(carouselContent).children('.slider-content-item').length;
  
  
  arrowRight.addEventListener("click", function (e) {
  
    
  
    moove = moove - 100;
  
    if (moove < -((countChildrenElement - 1) * 100)) {
    moove = 0;
    }
  
  
    return carouselContent.style.left = moove + "%";
  });
  
  arrowLeft.addEventListener("click", function (event) {
  
    moove = moove + 100;
  
    if (moove > 0) {
    moove = -((countChildrenElement - 1) * 100);
    }
  
   
    return carouselContent.style.left = moove + "%";
  });
  
  
  }
  
  carousel(arrowLeft, arrowRight, carouselContent, 0, ) */
})()

;(function() {
  const hamburger = document.querySelector(".hamburger");
  const fullMenu = document.querySelector(".full-menu");
  const closeBtn = document.querySelector("#close-full-menu");
  const FullMenuItem = document.querySelectorAll(".full-menu-item");
  const wrapper = document.querySelector(".wrapper");
  
  hamburger.addEventListener("click", function (event) {
    fullMenu.style.left = "0";
  });
  
  closeBtn.addEventListener("click", function (event) {
    fullMenu.style.left = "100%";
  });
  
  FullMenuItem.forEach(function (element) {
    element.addEventListener("click", function (event) {
      fullMenu.style.left = "100%";
    });
  });
  
  fullMenu.addEventListener("click", function(e){
    if (e.target.className == 'full-menu') {
    fullMenu.style.left = "100%";
    }
  })
  
  window.addEventListener("resize", function (event) {
    if (event.currentTarget.innerWidth > 767) {
      fullMenu.style.left = "100%";
    }
  });
  
})()



;(function() {
  let myMap;

  const init = () => {
    myMap = new ymaps.Map("map", {
      // Координаты центра карты.
      // Порядок по умолчанию: «широта, долгота».
      // Чтобы не определять координаты центра карты вручную,
      // воспользуйтесь инструментом Определение координат.
      center: [55.03, 82.92],
      // Уровень масштабирования. Допустимые значения:
      // от 0 (весь мир) до 19.
      zoom: 16,
      controls:[]
  });
  
  const coords = [
    [55.030439, 82.924504],
    [55.028631, 82.918379],
    [55.031376, 82.917726]
  ];
  
  
  var myCollection = new ymaps.GeoObjectCollection({},{
  
    draggable: false,
    iconLayout: 'default#image',
    iconImageHref: './icons/icon_map.svg',
      iconImageSize: [46, 57],
      iconImageOffset: [-35, -52]
  });
  
  coords.forEach(coord => {
    myCollection.add(new ymaps.Placemark(coord))
  });
  
  myMap.geoObjects.add(myCollection);
  
  myMap.behaviors.disable('scrollZoom');
  
  }
  
  ymaps.ready(init);
})()



;(function() {
  const validateFields = (form, fieldsArray) => {
    fieldsArray.forEach((field) => {
      field.removeClass("input-error");
  
      if (field.val().trim() == "") {
        field.addClass("input-error");
      }
    });
  
    const errorFields = form.find(".input-error");
    return errorFields.length == 0;
  };
  
  $(".form").submit((e) => {
    e.preventDefault();
  
    const form = $(e.currentTarget);
    const name = form.find("[name='name']");
    const phone = form.find("[name='phone']");
    const comment = form.find("[name='comment']");
    const to = form.find("[name='to']");
  
    const modal = $("#modal");
    const content = modal.find(".modal__content");
  
    modal.removeClass("modal-error");
  
    const isValid = validateFields(form, [name, phone, comment, to]);
  
    if (isValid) {
      const request = $.ajax({
        url: "https://webdev-api.loftschool.com/sendmail",
        method: "post",
        data: {
          name: name.val(),
          phone: phone.val(),
          comment: comment.val(),
          to: to.val(),
        },
      });
  
      request.done((data) => {
        content.text(data.message);
      });
  
      request.fail((data) => {
        const message = data.responseJSON.message;
        content.text(message);
        modal.addClass("modal-error");
      });
  
      request.always(() => {
        $.fancybox.open({
          src: "#modal",
          type: "inline",
        });
      });
    }
  });
  
  $(".app-close-modal").click((e) => {
    e.preventDefault();
  
    $.fancybox.close();
  });
})()



;(function () {
  const sections = $("section");
  const display = $(".main__content");
  const sideMenu = $(".fixed-menu");
  const sideMenuItems = sideMenu.find(".fixed-menu__item");

  const mobileDetect = new MobileDetect(window.navigator.userAgent);
  const isMobile = mobileDetect.mobile();

  let inScroll = false;

  sections.first().addClass("active");

  const countSectionPosition = (sectionEq) => {
    const position = sectionEq * -100;

    if (isNaN(position)) {
      console.error("передано неверное значение в countSectionPosition");
      return 0;
    }

    return position;
  };

  const resetActiveClassForItem = (items, itemEq, activeClass) => {
    items.eq(itemEq).addClass(activeClass).siblings().removeClass(activeClass);
  };

  //функция запускающая анимацию
  const performTransition = (sectionEq) => {
    if (inScroll) return;

    inScroll = true;
    const position = countSectionPosition(sectionEq);

    display.css({
      transform: `translateY(${position}%)`,
    });

    resetActiveClassForItem(sections, sectionEq, "active");

    setTimeout(() => {
      inScroll = false;
      resetActiveClassForItem(
        sideMenuItems,
        sectionEq,
        "fixed-menu__item_active"
      );
    }, 1500);
  };

  // функция определяюзаяя к какой секции скролить
  const viewportScroller = () => {
    const activeSection = sections.filter(".active");
    const nextSection = activeSection.next();
    const prevSection = activeSection.prev();

    return {
      next() {
        if (nextSection.length) {
          performTransition(nextSection.index());
        }
      },

      prev() {
        if (prevSection.length) {
          performTransition(prevSection.index());
        }
      },
    };
  };

  $(window).on("wheel", (e) => {
    const deltaY = e.originalEvent.deltaY;
    const scroller = viewportScroller();
    if (deltaY > 0) {
      scroller.next();
    }

    if (deltaY < 0) {
      scroller.prev();
    }
  });

  $(window).on("keydown", (e) => {
    const tagName = e.target.tagName.toLowerCase();
    const userTypingInInputs = tagName == "input" || tagName == "textarea";
    const scroller = viewportScroller();

    if (userTypingInInputs) return;

    switch (e.keyCode) {
      case 40: //prev
        scroller.next();
        break;

      case 38: //next
        scroller.prev();
        break;
    }
  });

  $(".wrapper").on("touchmove", (e) => {
    e.preventDefault();
  });

  $("[data-scroll-to]").click((e) => {
    e.preventDefault();

    const $this = $(e.currentTarget);
    const target = $this.attr("data-scroll-to");
    const reqSection = $(`[data-section-id = ${target}]`);

    performTransition(reqSection.index());
  });

  /* if (isMobile) {
    $("body").swipe( {
      //Generic swipe handler for all directions
      swipe:function(event,direction) {
        
       const scroller = viewportScroller(); 
       let scrollDirection = "";
       
    
       if (direction == "up") scrollDirection = "next";
       if (direction == "down") scrollDirection = "prev";
    
       scroller[scrollDirection]();
    }
    })
  
  }
   */
  if (isMobile) {
    $("body").swipe({
      swipe: function (event, direction) {
        const scroller = viewportScroller();
        let scrollDirection = "";
        if (direction == "up") {
          scrollDirection = "next";
        }

        if (direction == "down") {
          scrollDirection = "prev";
        }

        scroller[scrollDirection]();
      },
    });
  }
})();

;(function() {
//объявляем переменные:

//переменная с круглыми аватарками


const avatars = $('.interactive-avatar');

const displayInner = $('.rewievs__display-inner');


/* const avatars = $('[data-from]');

const displayInner = $('[data-to]');



avatars.on('click', e => {
    e.preventDefault();
    const $this = $(e.currentTarget);

    const displayInnerData = displayInner

    avatars.removeClass('interactive-avatar_active');


    if ($this.hasClass('interactive-avatar')) {
        $this.addClass('interactive-avatar_active')
    }



})  */





//объявляем цикл который перебирает все круглые аватарки
for (let i = 0; i < avatars.length; i++) {
    //присваиваем элементу цикла(конкретной аватрке) переменную элемент
    let element = avatars[i];

    //создаем событие клика на аватарку и функцию которая выполняется при клике
    element.addEventListener("click", function (e) {

        //Внтури функции:

        //отменяем стандартное действие браузера при клике на элемент(ссылка)
        e.preventDefault()

        //снова объявляем цикл который перебирает все круглые аватарки
        for (let index = 0; index < avatars.length; index++) {

            //убираем активный класс всем аватаркам при клике, на тех на которых он есть
            avatars[index].classList.remove('interactive-avatar_active')
            //убираем активный класс дисплею при клике, на тех на которых он есть
            displayInner[index].classList.remove('rewievs__display-inner_active')

        }
        //присваиваем активный класс аватарке, на которурую произвели клик
        displayInner[i].classList.add('rewievs__display-inner_active');
        //присваиваем активный класс дисплею
        e.currentTarget.classList.add('interactive-avatar_active');
    })
}




/* function change(target, 
                i, 
                avatars,
                displayInner, 
                avatarsActive, 
                displayInnerActive, 
                e) {

    e.preventDefault();

    for (let index = 0; 
         index < avatars.length; 
         index++) {

        avatars[index].classList.remove(avatarsActive)
        displayInner[index].classList.remove(displayInnerActive)
    }

    displayInner[i].classList.add(displayInnerActive);
    target.classList.add(avatarsActive);
};



for (let i = 0; 
     i < avatars.length; 
     i++) {

    let element = avatars[i];

    element.addEventListener("click", function (e) {
        
    change( e.currentTarget, 
            i, 
            avatars, 
            displayInner, 
            'interactive-avatar_active', 
            'rewievs__display-inner_active',
            e)
    })
} */
})()


;(function() {
const openItem = function (item) {
  const container = item.closest(".teammate-item");
  const contentBlock = container.find(".position-wrapper");
  const textBLock = contentBlock.find(".position");
  const reqHeight = textBLock.height();
  const arrow = container.find(".team__desc-arrow-img");

  container.addClass("teammate-item_active");
  arrow.addClass("team__desc-arrow-img_active");

  contentBlock.height(reqHeight);
};




const closeEveryItem = function (container) {
  const items = container.find(".position-wrapper");
  const itemContainer = container.find(".teammate-item");
  const itemArrow = container.find(".team__desc-arrow-img");
  items.height(0);

  itemArrow.removeClass("team__desc-arrow-img_active");
  itemContainer.removeClass("teammate-item_active");
};




$(".teammate-name-wrapper").on("click", function (e) {
  const $this = $(e.currentTarget);
  const container = $this.closest(".team");
  const elemContainer = $this.closest(".teammate-item");

  if (elemContainer.hasClass("teammate-item_active")) {
    closeEveryItem(container);
  } else {
    closeEveryItem(container);
    openItem($this);
  }
});

/* const items = $('.teammate-name-wrapper');
const positionWrapper = $('.position-wrapper');
const arrow = $('.team__desc-arrow-img');

items.each((i,item) => {

$(item).on('click', function (e) {

  items.each((j,elem) =>  {

    if (j != i) {
      $(positionWrapper[j]).removeClass('position-wrapper_active');
      $(arrow[j]).removeClass('team__desc-arrow-img_active');
       }

  })
  
    $(positionWrapper[i]).toggleClass('position-wrapper_active');
    $(arrow[i]).toggleClass('team__desc-arrow-img_active');
    
  })

}) */

/* const items = document.querySelectorAll('.teammate-name-wrapper');
const positionWrapper = document.querySelectorAll('.position-wrapper');
const arrow = document.querySelectorAll('.team__desc-arrow-img');


for (let i = 0; i < items.length; i++) {

  let element = items[i];

  element.addEventListener("click", function (e) { 

    for (let j = 0; j < items.length; j++) {


    if (j != i) {
    positionWrapper[j].classList.remove('position-wrapper_active');
    arrow[j].classList.remove('team__desc-arrow-img_active');
     }


    }

    positionWrapper[i].classList.toggle('position-wrapper_active');
    arrow[i].classList.toggle('team__desc-arrow-img_active');
    
    

  })

} */

})()



/* const openAcco = (item) => {

item.addClass("acco-item_active");

}



const closeAcco = (list) => {

  const listItem = list.find(".acco-item"); 
  listItem.removeClass("acco-item_active");

  }


$(".acco-title-wrapper").on('click', (e) => {
    e.preventDefault();
    const $this = $(e.currentTarget);
    const itemContainer = $this.closest(".acco-item");
    const accoList = itemContainer.closest(".acco-list");
    
if (itemContainer.hasClass("acco-item_active")) {
    closeAcco(accoList);



} else {
    closeAcco(accoList);
    openAcco(itemContainer);

    }
}) */





;(function() {


  const maxWidth = document.body.clientWidth;
  console.log(maxWidth);

  
  const openAcco = (item) => {
    item.addClass("acco-item_active");
    
  };
  
  const closeAcco = (list) => {
    const listItem = list.find(".acco-item");
    listItem.removeClass("acco-item_active");
  };
  

  let currWidth = document.body.clientWidth;

  $(window).on('resize', function(e) {
    currWidth = document.body.clientWidth;
    console.log(currWidth);
  })
  
  
  
  $(".acco-item").on("click", (e) => {
    e.preventDefault();
    console.log(currWidth);
    
    if (currWidth > 480) {
      
      if ($(e.target).hasClass("acco-title-wrapper") || $(e.target).hasClass("acco-title")) {
        const $this = $(e.target);
        const itemContainer = $this.closest(".acco-item");
        const accoList = itemContainer.closest(".acco-list");
    
    
        if (itemContainer.hasClass("acco-item_active")) {
          closeAcco(accoList);
        } else {
          closeAcco(accoList);
          openAcco(itemContainer);
        }
      }
    
      if ($(e.target).hasClass("close-x") || $(e.target).hasClass("close-vert-menu")) {
        const target = $(e.target);
        const Items = target.closest(".acco-list");
    
        closeAcco(Items)
      } 
    } else {
        let itemToAdd = $(`<div class="added-item"></div>`);
        itemToAdd.html($(e.currentTarget).html());

        if (!$('.added-item').length) {
          $('.vertical-menu__section').append(itemToAdd);

          setTimeout(() => {
          itemToAdd.addClass("added-item_active")
          }, 100);

          /* itemToAdd.addClass("added-item_active") */
          $('.added-item').on('click', function (e) {
            const $target = $(e.target)
            if ($target.hasClass('close-x') || $target.hasClass('acco-title-wrapper') || $target.hasClass('acco-title')) {

              console.log(e.target);
              itemToAdd.removeClass("added-item_active")
              setTimeout(() => {
                itemToAdd.remove()
                }, 500);
            }

            
            
          })
        }
      }
     
  });
  
})()


;(function() {
  const player = $(".player-elem")[0];
  const playerContainer = $(".player");
  
  $(".play-stop").click((e) => {
    e.preventDefault();
  
    if (playerContainer.hasClass("player_paused")) {
      playerContainer.removeClass("player_paused");
      playerContainer.removeClass("player_active");
      player.pause();
    } else {
      playerContainer.addClass("player_paused");
      player.play();
    }
  });
  
  $(".playback__slider-line").click((e) => {
    const line = $(e.currentTarget);
    const clickedPos = e.originalEvent.layerX;
    const newBtnPosPrecent = (clickedPos / line.width()) * 100;
  
    $(".playback__btn").css({
      left: `${newBtnPosPrecent}%`,
    });
  
    player.pause();
    player.currentTime = player.duration * (clickedPos / line.width());
    player.play();
    playerContainer.addClass("player_paused");
  });
  
  $(player).on("timeupdate", function () {
    let playBackBtn = $(".playback__btn");
    let timeProgress = (player.currentTime / player.duration) * 100 + "%";
    playBackBtn.css("left", timeProgress);
  });
  
  $(".volume__slider-line").click((e) => {
    const volumeLine = $(e.currentTarget);
    const volumeClickedPos = e.originalEvent.layerX;
  
    const volBtnPosPrecent = (volumeClickedPos / volumeLine.width()) * 100;
  
    $(".volume__slider-btn").css({
      left: `${volBtnPosPrecent}%`,
    });
    player.volume = volBtnPosPrecent / 100;
  
    if (playerContainer.hasClass("player__sound-off")) {
      playerContainer.removeClass("player__sound-off");
      player.muted = false;
    }
  });
  
  $(".player-elem").on("play", (e) => {
    playerContainer.addClass("player_active ");
  });
  
  $(".player-splash").on("click", (e) => {
    playerContainer.addClass("player_active player_paused");
    player.play();
  });
  
  $(".volume__icons-wrapper").on("click", (e) => {
    if (playerContainer.hasClass("player__sound-off")) {
      playerContainer.removeClass("player__sound-off");
      player.muted = false;
    } else if ($(e.target).filter("close")) {
      playerContainer.addClass("player__sound-off");
      player.muted = true;
    }
  
  });
  
})()




//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhcm91c2VsLmpzIiwiaGFtYnVyZ2VyLW1lbnUuanMiLCJtYXAuanMiLCJtb2RhbC5qcyIsIm9uZVBhZ2VTY3JvbGwuanMiLCJzbGlkZS1zaG93LmpzIiwidGVhbS1hY2NvcmRpb24uanMiLCJ2ZXJ0aWNhbC1hY2NvLmpzIiwidmlkZW8uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDbkZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDcENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM5Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNyRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDeEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2pIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNyR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzVIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCkge1xyXG4gIGZ1bmN0aW9uIGNhcm91c2VsKGFycm93UmlnaHQsIGFycm93TGVmdCwgbW9vdmUsIGNhcm91c2VsQ29udGVudCkge1xyXG5cclxuICAgIGxldCBjb3VudENoaWxkcmVuRWxlbWVudCA9ICQoY2Fyb3VzZWxDb250ZW50KS5jaGlsZHJlbignLnNsaWRlci1jb250ZW50LWl0ZW0nKS5sZW5ndGg7XHJcbiAgXHJcbiAgXHJcbiAgICBhcnJvd1JpZ2h0Lm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICBtb292ZSAtPSAxMDA7XHJcbiAgXHJcbiAgICAgIGlmIChtb292ZSA8IC0oKGNvdW50Q2hpbGRyZW5FbGVtZW50IC0gMSkgKiAxMDApKSB7XHJcbiAgICAgICAgbW9vdmUgPSAwO1xyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIHJldHVybiBjYXJvdXNlbENvbnRlbnQuY3NzKFwibGVmdFwiLCAobW9vdmUgKyBcIiVcIikpO1xyXG4gICAgfSk7XHJcbiAgXHJcbiAgICBhcnJvd0xlZnQub24oXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgIG1vb3ZlICs9IDEwMDtcclxuICBcclxuICAgICAgaWYgKG1vb3ZlID4gMCkge1xyXG4gICAgICAgIG1vb3ZlID0gLSgoY291bnRDaGlsZHJlbkVsZW1lbnQgLSAxKSAqIDEwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgICBcclxuICBcclxuICAgICAgcmV0dXJuIGNhcm91c2VsQ29udGVudC5jc3MoXCJsZWZ0XCIsIChtb292ZSArIFwiJVwiKSk7XHJcbiAgICB9KTtcclxuICBcclxuICAgIFxyXG4gIH1cclxuICBcclxuICBjYXJvdXNlbChcclxuICAgICQoXCIuc2xpZGVyX2Fycm93LXJpZ2h0LXdyYXBwZXJcIiksXHJcbiAgICAkKFwiLnNsaWRlcl9fYXJyb3ctbGVmdC13cmFwcGVyXCIpLFxyXG4gICAgMCxcclxuICAgICQoXCIuc2xpZGVyLWNvbnRlbnQtbGlzdFwiKVxyXG4gICk7IFxyXG4gIFxyXG4gIFxyXG4gIC8qIGNvbnN0IGFycm93TGVmdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVyX19hcnJvdy1sZWZ0LXdyYXBwZXJcIik7XHJcbiAgY29uc3QgYXJyb3dSaWdodCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc2xpZGVyX2Fycm93LXJpZ2h0LXdyYXBwZXJcIik7XHJcbiAgY29uc3QgY2Fyb3VzZWxDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zbGlkZXItY29udGVudC1saXN0XCIpO1xyXG4gIGNvbnN0IGNhcm91c2VsSXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2xpZGVyLWNvbnRlbnQtaXRlbVwiKVxyXG4gIFxyXG4gIGxldCBtb292ZSA9IDA7XHJcbiAgXHJcbiAgXHJcbiAgXHJcbiAgZnVuY3Rpb24gY2Fyb3VzZWwoYXJyb3dMZWZ0LCBhcnJvd1JpZ2h0LCBjYXJvdXNlbENvbnRlbnQsIG1vb3ZlKSB7XHJcbiAgXHJcbiAgbGV0IGNvdW50Q2hpbGRyZW5FbGVtZW50ID0gJChjYXJvdXNlbENvbnRlbnQpLmNoaWxkcmVuKCcuc2xpZGVyLWNvbnRlbnQtaXRlbScpLmxlbmd0aDtcclxuICBcclxuICBcclxuICBhcnJvd1JpZ2h0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xyXG4gIFxyXG4gICAgXHJcbiAgXHJcbiAgICBtb292ZSA9IG1vb3ZlIC0gMTAwO1xyXG4gIFxyXG4gICAgaWYgKG1vb3ZlIDwgLSgoY291bnRDaGlsZHJlbkVsZW1lbnQgLSAxKSAqIDEwMCkpIHtcclxuICAgIG1vb3ZlID0gMDtcclxuICAgIH1cclxuICBcclxuICBcclxuICAgIHJldHVybiBjYXJvdXNlbENvbnRlbnQuc3R5bGUubGVmdCA9IG1vb3ZlICsgXCIlXCI7XHJcbiAgfSk7XHJcbiAgXHJcbiAgYXJyb3dMZWZ0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICBcclxuICAgIG1vb3ZlID0gbW9vdmUgKyAxMDA7XHJcbiAgXHJcbiAgICBpZiAobW9vdmUgPiAwKSB7XHJcbiAgICBtb292ZSA9IC0oKGNvdW50Q2hpbGRyZW5FbGVtZW50IC0gMSkgKiAxMDApO1xyXG4gICAgfVxyXG4gIFxyXG4gICBcclxuICAgIHJldHVybiBjYXJvdXNlbENvbnRlbnQuc3R5bGUubGVmdCA9IG1vb3ZlICsgXCIlXCI7XHJcbiAgfSk7XHJcbiAgXHJcbiAgXHJcbiAgfVxyXG4gIFxyXG4gIGNhcm91c2VsKGFycm93TGVmdCwgYXJyb3dSaWdodCwgY2Fyb3VzZWxDb250ZW50LCAwLCApICovXHJcbn0pKClcclxuIiwiOyhmdW5jdGlvbigpIHtcclxuICBjb25zdCBoYW1idXJnZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhhbWJ1cmdlclwiKTtcclxuICBjb25zdCBmdWxsTWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZnVsbC1tZW51XCIpO1xyXG4gIGNvbnN0IGNsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjbG9zZS1mdWxsLW1lbnVcIik7XHJcbiAgY29uc3QgRnVsbE1lbnVJdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5mdWxsLW1lbnUtaXRlbVwiKTtcclxuICBjb25zdCB3cmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53cmFwcGVyXCIpO1xyXG4gIFxyXG4gIGhhbWJ1cmdlci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICBmdWxsTWVudS5zdHlsZS5sZWZ0ID0gXCIwXCI7XHJcbiAgfSk7XHJcbiAgXHJcbiAgY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgZnVsbE1lbnUuc3R5bGUubGVmdCA9IFwiMTAwJVwiO1xyXG4gIH0pO1xyXG4gIFxyXG4gIEZ1bGxNZW51SXRlbS5mb3JFYWNoKGZ1bmN0aW9uIChlbGVtZW50KSB7XHJcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgZnVsbE1lbnUuc3R5bGUubGVmdCA9IFwiMTAwJVwiO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbiAgXHJcbiAgZnVsbE1lbnUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uKGUpe1xyXG4gICAgaWYgKGUudGFyZ2V0LmNsYXNzTmFtZSA9PSAnZnVsbC1tZW51Jykge1xyXG4gICAgZnVsbE1lbnUuc3R5bGUubGVmdCA9IFwiMTAwJVwiO1xyXG4gICAgfVxyXG4gIH0pXHJcbiAgXHJcbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNpemVcIiwgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICBpZiAoZXZlbnQuY3VycmVudFRhcmdldC5pbm5lcldpZHRoID4gNzY3KSB7XHJcbiAgICAgIGZ1bGxNZW51LnN0eWxlLmxlZnQgPSBcIjEwMCVcIjtcclxuICAgIH1cclxuICB9KTtcclxuICBcclxufSkoKVxyXG5cclxuXHJcbiIsIjsoZnVuY3Rpb24oKSB7XHJcbiAgbGV0IG15TWFwO1xyXG5cclxuICBjb25zdCBpbml0ID0gKCkgPT4ge1xyXG4gICAgbXlNYXAgPSBuZXcgeW1hcHMuTWFwKFwibWFwXCIsIHtcclxuICAgICAgLy8g0JrQvtC+0YDQtNC40L3QsNGC0Ysg0YbQtdC90YLRgNCwINC60LDRgNGC0YsuXHJcbiAgICAgIC8vINCf0L7RgNGP0LTQvtC6INC/0L4g0YPQvNC+0LvRh9Cw0L3QuNGOOiDCq9GI0LjRgNC+0YLQsCwg0LTQvtC70LPQvtGC0LDCuy5cclxuICAgICAgLy8g0KfRgtC+0LHRiyDQvdC1INC+0L/RgNC10LTQtdC70Y/RgtGMINC60L7QvtGA0LTQuNC90LDRgtGLINGG0LXQvdGC0YDQsCDQutCw0YDRgtGLINCy0YDRg9GH0L3Rg9GOLFxyXG4gICAgICAvLyDQstC+0YHQv9C+0LvRjNC30YPQudGC0LXRgdGMINC40L3RgdGC0YDRg9C80LXQvdGC0L7QvCDQntC/0YDQtdC00LXQu9C10L3QuNC1INC60L7QvtGA0LTQuNC90LDRgi5cclxuICAgICAgY2VudGVyOiBbNTUuMDMsIDgyLjkyXSxcclxuICAgICAgLy8g0KPRgNC+0LLQtdC90Ywg0LzQsNGB0YjRgtCw0LHQuNGA0L7QstCw0L3QuNGPLiDQlNC+0L/Rg9GB0YLQuNC80YvQtSDQt9C90LDRh9C10L3QuNGPOlxyXG4gICAgICAvLyDQvtGCIDAgKNCy0LXRgdGMINC80LjRgCkg0LTQviAxOS5cclxuICAgICAgem9vbTogMTYsXHJcbiAgICAgIGNvbnRyb2xzOltdXHJcbiAgfSk7XHJcbiAgXHJcbiAgY29uc3QgY29vcmRzID0gW1xyXG4gICAgWzU1LjAzMDQzOSwgODIuOTI0NTA0XSxcclxuICAgIFs1NS4wMjg2MzEsIDgyLjkxODM3OV0sXHJcbiAgICBbNTUuMDMxMzc2LCA4Mi45MTc3MjZdXHJcbiAgXTtcclxuICBcclxuICBcclxuICB2YXIgbXlDb2xsZWN0aW9uID0gbmV3IHltYXBzLkdlb09iamVjdENvbGxlY3Rpb24oe30se1xyXG4gIFxyXG4gICAgZHJhZ2dhYmxlOiBmYWxzZSxcclxuICAgIGljb25MYXlvdXQ6ICdkZWZhdWx0I2ltYWdlJyxcclxuICAgIGljb25JbWFnZUhyZWY6ICcuL2ljb25zL2ljb25fbWFwLnN2ZycsXHJcbiAgICAgIGljb25JbWFnZVNpemU6IFs0NiwgNTddLFxyXG4gICAgICBpY29uSW1hZ2VPZmZzZXQ6IFstMzUsIC01Ml1cclxuICB9KTtcclxuICBcclxuICBjb29yZHMuZm9yRWFjaChjb29yZCA9PiB7XHJcbiAgICBteUNvbGxlY3Rpb24uYWRkKG5ldyB5bWFwcy5QbGFjZW1hcmsoY29vcmQpKVxyXG4gIH0pO1xyXG4gIFxyXG4gIG15TWFwLmdlb09iamVjdHMuYWRkKG15Q29sbGVjdGlvbik7XHJcbiAgXHJcbiAgbXlNYXAuYmVoYXZpb3JzLmRpc2FibGUoJ3Njcm9sbFpvb20nKTtcclxuICBcclxuICB9XHJcbiAgXHJcbiAgeW1hcHMucmVhZHkoaW5pdCk7XHJcbn0pKClcclxuXHJcblxyXG4iLCI7KGZ1bmN0aW9uKCkge1xyXG4gIGNvbnN0IHZhbGlkYXRlRmllbGRzID0gKGZvcm0sIGZpZWxkc0FycmF5KSA9PiB7XHJcbiAgICBmaWVsZHNBcnJheS5mb3JFYWNoKChmaWVsZCkgPT4ge1xyXG4gICAgICBmaWVsZC5yZW1vdmVDbGFzcyhcImlucHV0LWVycm9yXCIpO1xyXG4gIFxyXG4gICAgICBpZiAoZmllbGQudmFsKCkudHJpbSgpID09IFwiXCIpIHtcclxuICAgICAgICBmaWVsZC5hZGRDbGFzcyhcImlucHV0LWVycm9yXCIpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICBcclxuICAgIGNvbnN0IGVycm9yRmllbGRzID0gZm9ybS5maW5kKFwiLmlucHV0LWVycm9yXCIpO1xyXG4gICAgcmV0dXJuIGVycm9yRmllbGRzLmxlbmd0aCA9PSAwO1xyXG4gIH07XHJcbiAgXHJcbiAgJChcIi5mb3JtXCIpLnN1Ym1pdCgoZSkgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIFxyXG4gICAgY29uc3QgZm9ybSA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICAgIGNvbnN0IG5hbWUgPSBmb3JtLmZpbmQoXCJbbmFtZT0nbmFtZSddXCIpO1xyXG4gICAgY29uc3QgcGhvbmUgPSBmb3JtLmZpbmQoXCJbbmFtZT0ncGhvbmUnXVwiKTtcclxuICAgIGNvbnN0IGNvbW1lbnQgPSBmb3JtLmZpbmQoXCJbbmFtZT0nY29tbWVudCddXCIpO1xyXG4gICAgY29uc3QgdG8gPSBmb3JtLmZpbmQoXCJbbmFtZT0ndG8nXVwiKTtcclxuICBcclxuICAgIGNvbnN0IG1vZGFsID0gJChcIiNtb2RhbFwiKTtcclxuICAgIGNvbnN0IGNvbnRlbnQgPSBtb2RhbC5maW5kKFwiLm1vZGFsX19jb250ZW50XCIpO1xyXG4gIFxyXG4gICAgbW9kYWwucmVtb3ZlQ2xhc3MoXCJtb2RhbC1lcnJvclwiKTtcclxuICBcclxuICAgIGNvbnN0IGlzVmFsaWQgPSB2YWxpZGF0ZUZpZWxkcyhmb3JtLCBbbmFtZSwgcGhvbmUsIGNvbW1lbnQsIHRvXSk7XHJcbiAgXHJcbiAgICBpZiAoaXNWYWxpZCkge1xyXG4gICAgICBjb25zdCByZXF1ZXN0ID0gJC5hamF4KHtcclxuICAgICAgICB1cmw6IFwiaHR0cHM6Ly93ZWJkZXYtYXBpLmxvZnRzY2hvb2wuY29tL3NlbmRtYWlsXCIsXHJcbiAgICAgICAgbWV0aG9kOiBcInBvc3RcIixcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICBuYW1lOiBuYW1lLnZhbCgpLFxyXG4gICAgICAgICAgcGhvbmU6IHBob25lLnZhbCgpLFxyXG4gICAgICAgICAgY29tbWVudDogY29tbWVudC52YWwoKSxcclxuICAgICAgICAgIHRvOiB0by52YWwoKSxcclxuICAgICAgICB9LFxyXG4gICAgICB9KTtcclxuICBcclxuICAgICAgcmVxdWVzdC5kb25lKChkYXRhKSA9PiB7XHJcbiAgICAgICAgY29udGVudC50ZXh0KGRhdGEubWVzc2FnZSk7XHJcbiAgICAgIH0pO1xyXG4gIFxyXG4gICAgICByZXF1ZXN0LmZhaWwoKGRhdGEpID0+IHtcclxuICAgICAgICBjb25zdCBtZXNzYWdlID0gZGF0YS5yZXNwb25zZUpTT04ubWVzc2FnZTtcclxuICAgICAgICBjb250ZW50LnRleHQobWVzc2FnZSk7XHJcbiAgICAgICAgbW9kYWwuYWRkQ2xhc3MoXCJtb2RhbC1lcnJvclwiKTtcclxuICAgICAgfSk7XHJcbiAgXHJcbiAgICAgIHJlcXVlc3QuYWx3YXlzKCgpID0+IHtcclxuICAgICAgICAkLmZhbmN5Ym94Lm9wZW4oe1xyXG4gICAgICAgICAgc3JjOiBcIiNtb2RhbFwiLFxyXG4gICAgICAgICAgdHlwZTogXCJpbmxpbmVcIixcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgXHJcbiAgJChcIi5hcHAtY2xvc2UtbW9kYWxcIikuY2xpY2soKGUpID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICBcclxuICAgICQuZmFuY3lib3guY2xvc2UoKTtcclxuICB9KTtcclxufSkoKVxyXG5cclxuXHJcbiIsIjsoZnVuY3Rpb24gKCkge1xyXG4gIGNvbnN0IHNlY3Rpb25zID0gJChcInNlY3Rpb25cIik7XHJcbiAgY29uc3QgZGlzcGxheSA9ICQoXCIubWFpbl9fY29udGVudFwiKTtcclxuICBjb25zdCBzaWRlTWVudSA9ICQoXCIuZml4ZWQtbWVudVwiKTtcclxuICBjb25zdCBzaWRlTWVudUl0ZW1zID0gc2lkZU1lbnUuZmluZChcIi5maXhlZC1tZW51X19pdGVtXCIpO1xyXG5cclxuICBjb25zdCBtb2JpbGVEZXRlY3QgPSBuZXcgTW9iaWxlRGV0ZWN0KHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KTtcclxuICBjb25zdCBpc01vYmlsZSA9IG1vYmlsZURldGVjdC5tb2JpbGUoKTtcclxuXHJcbiAgbGV0IGluU2Nyb2xsID0gZmFsc2U7XHJcblxyXG4gIHNlY3Rpb25zLmZpcnN0KCkuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcblxyXG4gIGNvbnN0IGNvdW50U2VjdGlvblBvc2l0aW9uID0gKHNlY3Rpb25FcSkgPT4ge1xyXG4gICAgY29uc3QgcG9zaXRpb24gPSBzZWN0aW9uRXEgKiAtMTAwO1xyXG5cclxuICAgIGlmIChpc05hTihwb3NpdGlvbikpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcItC/0LXRgNC10LTQsNC90L4g0L3QtdCy0LXRgNC90L7QtSDQt9C90LDRh9C10L3QuNC1INCyIGNvdW50U2VjdGlvblBvc2l0aW9uXCIpO1xyXG4gICAgICByZXR1cm4gMDtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcG9zaXRpb247XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0gPSAoaXRlbXMsIGl0ZW1FcSwgYWN0aXZlQ2xhc3MpID0+IHtcclxuICAgIGl0ZW1zLmVxKGl0ZW1FcSkuYWRkQ2xhc3MoYWN0aXZlQ2xhc3MpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoYWN0aXZlQ2xhc3MpO1xyXG4gIH07XHJcblxyXG4gIC8v0YTRg9C90LrRhtC40Y8g0LfQsNC/0YPRgdC60LDRjtGJ0LDRjyDQsNC90LjQvNCw0YbQuNGOXHJcbiAgY29uc3QgcGVyZm9ybVRyYW5zaXRpb24gPSAoc2VjdGlvbkVxKSA9PiB7XHJcbiAgICBpZiAoaW5TY3JvbGwpIHJldHVybjtcclxuXHJcbiAgICBpblNjcm9sbCA9IHRydWU7XHJcbiAgICBjb25zdCBwb3NpdGlvbiA9IGNvdW50U2VjdGlvblBvc2l0aW9uKHNlY3Rpb25FcSk7XHJcblxyXG4gICAgZGlzcGxheS5jc3Moe1xyXG4gICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKCR7cG9zaXRpb259JSlgLFxyXG4gICAgfSk7XHJcblxyXG4gICAgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0oc2VjdGlvbnMsIHNlY3Rpb25FcSwgXCJhY3RpdmVcIik7XHJcblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIGluU2Nyb2xsID0gZmFsc2U7XHJcbiAgICAgIHJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtKFxyXG4gICAgICAgIHNpZGVNZW51SXRlbXMsXHJcbiAgICAgICAgc2VjdGlvbkVxLFxyXG4gICAgICAgIFwiZml4ZWQtbWVudV9faXRlbV9hY3RpdmVcIlxyXG4gICAgICApO1xyXG4gICAgfSwgMTUwMCk7XHJcbiAgfTtcclxuXHJcbiAgLy8g0YTRg9C90LrRhtC40Y8g0L7Qv9GA0LXQtNC10LvRj9GO0LfQsNGP0Y8g0Log0LrQsNC60L7QuSDRgdC10LrRhtC40Lgg0YHQutGA0L7Qu9C40YLRjFxyXG4gIGNvbnN0IHZpZXdwb3J0U2Nyb2xsZXIgPSAoKSA9PiB7XHJcbiAgICBjb25zdCBhY3RpdmVTZWN0aW9uID0gc2VjdGlvbnMuZmlsdGVyKFwiLmFjdGl2ZVwiKTtcclxuICAgIGNvbnN0IG5leHRTZWN0aW9uID0gYWN0aXZlU2VjdGlvbi5uZXh0KCk7XHJcbiAgICBjb25zdCBwcmV2U2VjdGlvbiA9IGFjdGl2ZVNlY3Rpb24ucHJldigpO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5leHQoKSB7XHJcbiAgICAgICAgaWYgKG5leHRTZWN0aW9uLmxlbmd0aCkge1xyXG4gICAgICAgICAgcGVyZm9ybVRyYW5zaXRpb24obmV4dFNlY3Rpb24uaW5kZXgoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgcHJldigpIHtcclxuICAgICAgICBpZiAocHJldlNlY3Rpb24ubGVuZ3RoKSB7XHJcbiAgICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbihwcmV2U2VjdGlvbi5pbmRleCgpKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sXHJcbiAgICB9O1xyXG4gIH07XHJcblxyXG4gICQod2luZG93KS5vbihcIndoZWVsXCIsIChlKSA9PiB7XHJcbiAgICBjb25zdCBkZWx0YVkgPSBlLm9yaWdpbmFsRXZlbnQuZGVsdGFZO1xyXG4gICAgY29uc3Qgc2Nyb2xsZXIgPSB2aWV3cG9ydFNjcm9sbGVyKCk7XHJcbiAgICBpZiAoZGVsdGFZID4gMCkge1xyXG4gICAgICBzY3JvbGxlci5uZXh0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGRlbHRhWSA8IDApIHtcclxuICAgICAgc2Nyb2xsZXIucHJldigpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICAkKHdpbmRvdykub24oXCJrZXlkb3duXCIsIChlKSA9PiB7XHJcbiAgICBjb25zdCB0YWdOYW1lID0gZS50YXJnZXQudGFnTmFtZS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgY29uc3QgdXNlclR5cGluZ0luSW5wdXRzID0gdGFnTmFtZSA9PSBcImlucHV0XCIgfHwgdGFnTmFtZSA9PSBcInRleHRhcmVhXCI7XHJcbiAgICBjb25zdCBzY3JvbGxlciA9IHZpZXdwb3J0U2Nyb2xsZXIoKTtcclxuXHJcbiAgICBpZiAodXNlclR5cGluZ0luSW5wdXRzKSByZXR1cm47XHJcblxyXG4gICAgc3dpdGNoIChlLmtleUNvZGUpIHtcclxuICAgICAgY2FzZSA0MDogLy9wcmV2XHJcbiAgICAgICAgc2Nyb2xsZXIubmV4dCgpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSAzODogLy9uZXh0XHJcbiAgICAgICAgc2Nyb2xsZXIucHJldigpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gIH0pO1xyXG5cclxuICAkKFwiLndyYXBwZXJcIikub24oXCJ0b3VjaG1vdmVcIiwgKGUpID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICB9KTtcclxuXHJcbiAgJChcIltkYXRhLXNjcm9sbC10b11cIikuY2xpY2soKGUpID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICAgIGNvbnN0IHRhcmdldCA9ICR0aGlzLmF0dHIoXCJkYXRhLXNjcm9sbC10b1wiKTtcclxuICAgIGNvbnN0IHJlcVNlY3Rpb24gPSAkKGBbZGF0YS1zZWN0aW9uLWlkID0gJHt0YXJnZXR9XWApO1xyXG5cclxuICAgIHBlcmZvcm1UcmFuc2l0aW9uKHJlcVNlY3Rpb24uaW5kZXgoKSk7XHJcbiAgfSk7XHJcblxyXG4gIC8qIGlmIChpc01vYmlsZSkge1xyXG4gICAgJChcImJvZHlcIikuc3dpcGUoIHtcclxuICAgICAgLy9HZW5lcmljIHN3aXBlIGhhbmRsZXIgZm9yIGFsbCBkaXJlY3Rpb25zXHJcbiAgICAgIHN3aXBlOmZ1bmN0aW9uKGV2ZW50LGRpcmVjdGlvbikge1xyXG4gICAgICAgIFxyXG4gICAgICAgY29uc3Qgc2Nyb2xsZXIgPSB2aWV3cG9ydFNjcm9sbGVyKCk7IFxyXG4gICAgICAgbGV0IHNjcm9sbERpcmVjdGlvbiA9IFwiXCI7XHJcbiAgICAgICBcclxuICAgIFxyXG4gICAgICAgaWYgKGRpcmVjdGlvbiA9PSBcInVwXCIpIHNjcm9sbERpcmVjdGlvbiA9IFwibmV4dFwiO1xyXG4gICAgICAgaWYgKGRpcmVjdGlvbiA9PSBcImRvd25cIikgc2Nyb2xsRGlyZWN0aW9uID0gXCJwcmV2XCI7XHJcbiAgICBcclxuICAgICAgIHNjcm9sbGVyW3Njcm9sbERpcmVjdGlvbl0oKTtcclxuICAgIH1cclxuICAgIH0pXHJcbiAgXHJcbiAgfVxyXG4gICAqL1xyXG4gIGlmIChpc01vYmlsZSkge1xyXG4gICAgJChcImJvZHlcIikuc3dpcGUoe1xyXG4gICAgICBzd2lwZTogZnVuY3Rpb24gKGV2ZW50LCBkaXJlY3Rpb24pIHtcclxuICAgICAgICBjb25zdCBzY3JvbGxlciA9IHZpZXdwb3J0U2Nyb2xsZXIoKTtcclxuICAgICAgICBsZXQgc2Nyb2xsRGlyZWN0aW9uID0gXCJcIjtcclxuICAgICAgICBpZiAoZGlyZWN0aW9uID09IFwidXBcIikge1xyXG4gICAgICAgICAgc2Nyb2xsRGlyZWN0aW9uID0gXCJuZXh0XCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZGlyZWN0aW9uID09IFwiZG93blwiKSB7XHJcbiAgICAgICAgICBzY3JvbGxEaXJlY3Rpb24gPSBcInByZXZcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHNjcm9sbGVyW3Njcm9sbERpcmVjdGlvbl0oKTtcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gIH1cclxufSkoKTtcclxuIiwiOyhmdW5jdGlvbigpIHtcclxuLy/QvtCx0YrRj9Cy0LvRj9C10Lwg0L/QtdGA0LXQvNC10L3QvdGL0LU6XHJcblxyXG4vL9C/0LXRgNC10LzQtdC90L3QsNGPINGBINC60YDRg9Cz0LvRi9C80Lgg0LDQstCw0YLQsNGA0LrQsNC80LhcclxuXHJcblxyXG5jb25zdCBhdmF0YXJzID0gJCgnLmludGVyYWN0aXZlLWF2YXRhcicpO1xyXG5cclxuY29uc3QgZGlzcGxheUlubmVyID0gJCgnLnJld2lldnNfX2Rpc3BsYXktaW5uZXInKTtcclxuXHJcblxyXG4vKiBjb25zdCBhdmF0YXJzID0gJCgnW2RhdGEtZnJvbV0nKTtcclxuXHJcbmNvbnN0IGRpc3BsYXlJbm5lciA9ICQoJ1tkYXRhLXRvXScpO1xyXG5cclxuXHJcblxyXG5hdmF0YXJzLm9uKCdjbGljaycsIGUgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7XHJcblxyXG4gICAgY29uc3QgZGlzcGxheUlubmVyRGF0YSA9IGRpc3BsYXlJbm5lclxyXG5cclxuICAgIGF2YXRhcnMucmVtb3ZlQ2xhc3MoJ2ludGVyYWN0aXZlLWF2YXRhcl9hY3RpdmUnKTtcclxuXHJcblxyXG4gICAgaWYgKCR0aGlzLmhhc0NsYXNzKCdpbnRlcmFjdGl2ZS1hdmF0YXInKSkge1xyXG4gICAgICAgICR0aGlzLmFkZENsYXNzKCdpbnRlcmFjdGl2ZS1hdmF0YXJfYWN0aXZlJylcclxuICAgIH1cclxuXHJcblxyXG5cclxufSkgICovXHJcblxyXG5cclxuXHJcblxyXG5cclxuLy/QvtCx0YrRj9Cy0LvRj9C10Lwg0YbQuNC60Lsg0LrQvtGC0L7RgNGL0Lkg0L/QtdGA0LXQsdC40YDQsNC10YIg0LLRgdC1INC60YDRg9Cz0LvRi9C1INCw0LLQsNGC0LDRgNC60LhcclxuZm9yIChsZXQgaSA9IDA7IGkgPCBhdmF0YXJzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAvL9C/0YDQuNGB0LLQsNC40LLQsNC10Lwg0Y3Qu9C10LzQtdC90YLRgyDRhtC40LrQu9CwKNC60L7QvdC60YDQtdGC0L3QvtC5INCw0LLQsNGC0YDQutC1KSDQv9C10YDQtdC80LXQvdC90YPRjiDRjdC70LXQvNC10L3RglxyXG4gICAgbGV0IGVsZW1lbnQgPSBhdmF0YXJzW2ldO1xyXG5cclxuICAgIC8v0YHQvtC30LTQsNC10Lwg0YHQvtCx0YvRgtC40LUg0LrQu9C40LrQsCDQvdCwINCw0LLQsNGC0LDRgNC60YMg0Lgg0YTRg9C90LrRhtC40Y4g0LrQvtGC0L7RgNCw0Y8g0LLRi9C/0L7Qu9C90Y/QtdGC0YHRjyDQv9GA0Lgg0LrQu9C40LrQtVxyXG4gICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcclxuXHJcbiAgICAgICAgLy/QktC90YLRg9GA0Lgg0YTRg9C90LrRhtC40Lg6XHJcblxyXG4gICAgICAgIC8v0L7RgtC80LXQvdGP0LXQvCDRgdGC0LDQvdC00LDRgNGC0L3QvtC1INC00LXQudGB0YLQstC40LUg0LHRgNCw0YPQt9C10YDQsCDQv9GA0Lgg0LrQu9C40LrQtSDQvdCwINGN0LvQtdC80LXQvdGCKNGB0YHRi9C70LrQsClcclxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcclxuXHJcbiAgICAgICAgLy/RgdC90L7QstCwINC+0LHRitGP0LLQu9GP0LXQvCDRhtC40LrQuyDQutC+0YLQvtGA0YvQuSDQv9C10YDQtdCx0LjRgNCw0LXRgiDQstGB0LUg0LrRgNGD0LPQu9GL0LUg0LDQstCw0YLQsNGA0LrQuFxyXG4gICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBhdmF0YXJzLmxlbmd0aDsgaW5kZXgrKykge1xyXG5cclxuICAgICAgICAgICAgLy/Rg9Cx0LjRgNCw0LXQvCDQsNC60YLQuNCy0L3Ri9C5INC60LvQsNGB0YEg0LLRgdC10Lwg0LDQstCw0YLQsNGA0LrQsNC8INC/0YDQuCDQutC70LjQutC1LCDQvdCwINGC0LXRhSDQvdCwINC60L7RgtC+0YDRi9GFINC+0L0g0LXRgdGC0YxcclxuICAgICAgICAgICAgYXZhdGFyc1tpbmRleF0uY2xhc3NMaXN0LnJlbW92ZSgnaW50ZXJhY3RpdmUtYXZhdGFyX2FjdGl2ZScpXHJcbiAgICAgICAgICAgIC8v0YPQsdC40YDQsNC10Lwg0LDQutGC0LjQstC90YvQuSDQutC70LDRgdGBINC00LjRgdC/0LvQtdGOINC/0YDQuCDQutC70LjQutC1LCDQvdCwINGC0LXRhSDQvdCwINC60L7RgtC+0YDRi9GFINC+0L0g0LXRgdGC0YxcclxuICAgICAgICAgICAgZGlzcGxheUlubmVyW2luZGV4XS5jbGFzc0xpc3QucmVtb3ZlKCdyZXdpZXZzX19kaXNwbGF5LWlubmVyX2FjdGl2ZScpXHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICAvL9C/0YDQuNGB0LLQsNC40LLQsNC10Lwg0LDQutGC0LjQstC90YvQuSDQutC70LDRgdGBINCw0LLQsNGC0LDRgNC60LUsINC90LAg0LrQvtGC0L7RgNGD0YDRg9GOINC/0YDQvtC40LfQstC10LvQuCDQutC70LjQulxyXG4gICAgICAgIGRpc3BsYXlJbm5lcltpXS5jbGFzc0xpc3QuYWRkKCdyZXdpZXZzX19kaXNwbGF5LWlubmVyX2FjdGl2ZScpO1xyXG4gICAgICAgIC8v0L/RgNC40YHQstCw0LjQstCw0LXQvCDQsNC60YLQuNCy0L3Ri9C5INC60LvQsNGB0YEg0LTQuNGB0L/Qu9C10Y5cclxuICAgICAgICBlLmN1cnJlbnRUYXJnZXQuY2xhc3NMaXN0LmFkZCgnaW50ZXJhY3RpdmUtYXZhdGFyX2FjdGl2ZScpO1xyXG4gICAgfSlcclxufVxyXG5cclxuXHJcblxyXG5cclxuLyogZnVuY3Rpb24gY2hhbmdlKHRhcmdldCwgXHJcbiAgICAgICAgICAgICAgICBpLCBcclxuICAgICAgICAgICAgICAgIGF2YXRhcnMsXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5SW5uZXIsIFxyXG4gICAgICAgICAgICAgICAgYXZhdGFyc0FjdGl2ZSwgXHJcbiAgICAgICAgICAgICAgICBkaXNwbGF5SW5uZXJBY3RpdmUsIFxyXG4gICAgICAgICAgICAgICAgZSkge1xyXG5cclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IFxyXG4gICAgICAgICBpbmRleCA8IGF2YXRhcnMubGVuZ3RoOyBcclxuICAgICAgICAgaW5kZXgrKykge1xyXG5cclxuICAgICAgICBhdmF0YXJzW2luZGV4XS5jbGFzc0xpc3QucmVtb3ZlKGF2YXRhcnNBY3RpdmUpXHJcbiAgICAgICAgZGlzcGxheUlubmVyW2luZGV4XS5jbGFzc0xpc3QucmVtb3ZlKGRpc3BsYXlJbm5lckFjdGl2ZSlcclxuICAgIH1cclxuXHJcbiAgICBkaXNwbGF5SW5uZXJbaV0uY2xhc3NMaXN0LmFkZChkaXNwbGF5SW5uZXJBY3RpdmUpO1xyXG4gICAgdGFyZ2V0LmNsYXNzTGlzdC5hZGQoYXZhdGFyc0FjdGl2ZSk7XHJcbn07XHJcblxyXG5cclxuXHJcbmZvciAobGV0IGkgPSAwOyBcclxuICAgICBpIDwgYXZhdGFycy5sZW5ndGg7IFxyXG4gICAgIGkrKykge1xyXG5cclxuICAgIGxldCBlbGVtZW50ID0gYXZhdGFyc1tpXTtcclxuXHJcbiAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgIFxyXG4gICAgY2hhbmdlKCBlLmN1cnJlbnRUYXJnZXQsIFxyXG4gICAgICAgICAgICBpLCBcclxuICAgICAgICAgICAgYXZhdGFycywgXHJcbiAgICAgICAgICAgIGRpc3BsYXlJbm5lciwgXHJcbiAgICAgICAgICAgICdpbnRlcmFjdGl2ZS1hdmF0YXJfYWN0aXZlJywgXHJcbiAgICAgICAgICAgICdyZXdpZXZzX19kaXNwbGF5LWlubmVyX2FjdGl2ZScsXHJcbiAgICAgICAgICAgIGUpXHJcbiAgICB9KVxyXG59ICovXHJcbn0pKClcclxuXHJcbiIsIjsoZnVuY3Rpb24oKSB7XHJcbmNvbnN0IG9wZW5JdGVtID0gZnVuY3Rpb24gKGl0ZW0pIHtcclxuICBjb25zdCBjb250YWluZXIgPSBpdGVtLmNsb3Nlc3QoXCIudGVhbW1hdGUtaXRlbVwiKTtcclxuICBjb25zdCBjb250ZW50QmxvY2sgPSBjb250YWluZXIuZmluZChcIi5wb3NpdGlvbi13cmFwcGVyXCIpO1xyXG4gIGNvbnN0IHRleHRCTG9jayA9IGNvbnRlbnRCbG9jay5maW5kKFwiLnBvc2l0aW9uXCIpO1xyXG4gIGNvbnN0IHJlcUhlaWdodCA9IHRleHRCTG9jay5oZWlnaHQoKTtcclxuICBjb25zdCBhcnJvdyA9IGNvbnRhaW5lci5maW5kKFwiLnRlYW1fX2Rlc2MtYXJyb3ctaW1nXCIpO1xyXG5cclxuICBjb250YWluZXIuYWRkQ2xhc3MoXCJ0ZWFtbWF0ZS1pdGVtX2FjdGl2ZVwiKTtcclxuICBhcnJvdy5hZGRDbGFzcyhcInRlYW1fX2Rlc2MtYXJyb3ctaW1nX2FjdGl2ZVwiKTtcclxuXHJcbiAgY29udGVudEJsb2NrLmhlaWdodChyZXFIZWlnaHQpO1xyXG59O1xyXG5cclxuXHJcblxyXG5cclxuY29uc3QgY2xvc2VFdmVyeUl0ZW0gPSBmdW5jdGlvbiAoY29udGFpbmVyKSB7XHJcbiAgY29uc3QgaXRlbXMgPSBjb250YWluZXIuZmluZChcIi5wb3NpdGlvbi13cmFwcGVyXCIpO1xyXG4gIGNvbnN0IGl0ZW1Db250YWluZXIgPSBjb250YWluZXIuZmluZChcIi50ZWFtbWF0ZS1pdGVtXCIpO1xyXG4gIGNvbnN0IGl0ZW1BcnJvdyA9IGNvbnRhaW5lci5maW5kKFwiLnRlYW1fX2Rlc2MtYXJyb3ctaW1nXCIpO1xyXG4gIGl0ZW1zLmhlaWdodCgwKTtcclxuXHJcbiAgaXRlbUFycm93LnJlbW92ZUNsYXNzKFwidGVhbV9fZGVzYy1hcnJvdy1pbWdfYWN0aXZlXCIpO1xyXG4gIGl0ZW1Db250YWluZXIucmVtb3ZlQ2xhc3MoXCJ0ZWFtbWF0ZS1pdGVtX2FjdGl2ZVwiKTtcclxufTtcclxuXHJcblxyXG5cclxuXHJcbiQoXCIudGVhbW1hdGUtbmFtZS13cmFwcGVyXCIpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcclxuICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICBjb25zdCBjb250YWluZXIgPSAkdGhpcy5jbG9zZXN0KFwiLnRlYW1cIik7XHJcbiAgY29uc3QgZWxlbUNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoXCIudGVhbW1hdGUtaXRlbVwiKTtcclxuXHJcbiAgaWYgKGVsZW1Db250YWluZXIuaGFzQ2xhc3MoXCJ0ZWFtbWF0ZS1pdGVtX2FjdGl2ZVwiKSkge1xyXG4gICAgY2xvc2VFdmVyeUl0ZW0oY29udGFpbmVyKTtcclxuICB9IGVsc2Uge1xyXG4gICAgY2xvc2VFdmVyeUl0ZW0oY29udGFpbmVyKTtcclxuICAgIG9wZW5JdGVtKCR0aGlzKTtcclxuICB9XHJcbn0pO1xyXG5cclxuLyogY29uc3QgaXRlbXMgPSAkKCcudGVhbW1hdGUtbmFtZS13cmFwcGVyJyk7XHJcbmNvbnN0IHBvc2l0aW9uV3JhcHBlciA9ICQoJy5wb3NpdGlvbi13cmFwcGVyJyk7XHJcbmNvbnN0IGFycm93ID0gJCgnLnRlYW1fX2Rlc2MtYXJyb3ctaW1nJyk7XHJcblxyXG5pdGVtcy5lYWNoKChpLGl0ZW0pID0+IHtcclxuXHJcbiQoaXRlbSkub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcclxuXHJcbiAgaXRlbXMuZWFjaCgoaixlbGVtKSA9PiAge1xyXG5cclxuICAgIGlmIChqICE9IGkpIHtcclxuICAgICAgJChwb3NpdGlvbldyYXBwZXJbal0pLnJlbW92ZUNsYXNzKCdwb3NpdGlvbi13cmFwcGVyX2FjdGl2ZScpO1xyXG4gICAgICAkKGFycm93W2pdKS5yZW1vdmVDbGFzcygndGVhbV9fZGVzYy1hcnJvdy1pbWdfYWN0aXZlJyk7XHJcbiAgICAgICB9XHJcblxyXG4gIH0pXHJcbiAgXHJcbiAgICAkKHBvc2l0aW9uV3JhcHBlcltpXSkudG9nZ2xlQ2xhc3MoJ3Bvc2l0aW9uLXdyYXBwZXJfYWN0aXZlJyk7XHJcbiAgICAkKGFycm93W2ldKS50b2dnbGVDbGFzcygndGVhbV9fZGVzYy1hcnJvdy1pbWdfYWN0aXZlJyk7XHJcbiAgICBcclxuICB9KVxyXG5cclxufSkgKi9cclxuXHJcbi8qIGNvbnN0IGl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRlYW1tYXRlLW5hbWUtd3JhcHBlcicpO1xyXG5jb25zdCBwb3NpdGlvbldyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9zaXRpb24td3JhcHBlcicpO1xyXG5jb25zdCBhcnJvdyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50ZWFtX19kZXNjLWFycm93LWltZycpO1xyXG5cclxuXHJcbmZvciAobGV0IGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHtcclxuXHJcbiAgbGV0IGVsZW1lbnQgPSBpdGVtc1tpXTtcclxuXHJcbiAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHsgXHJcblxyXG4gICAgZm9yIChsZXQgaiA9IDA7IGogPCBpdGVtcy5sZW5ndGg7IGorKykge1xyXG5cclxuXHJcbiAgICBpZiAoaiAhPSBpKSB7XHJcbiAgICBwb3NpdGlvbldyYXBwZXJbal0uY2xhc3NMaXN0LnJlbW92ZSgncG9zaXRpb24td3JhcHBlcl9hY3RpdmUnKTtcclxuICAgIGFycm93W2pdLmNsYXNzTGlzdC5yZW1vdmUoJ3RlYW1fX2Rlc2MtYXJyb3ctaW1nX2FjdGl2ZScpO1xyXG4gICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG5cclxuICAgIHBvc2l0aW9uV3JhcHBlcltpXS5jbGFzc0xpc3QudG9nZ2xlKCdwb3NpdGlvbi13cmFwcGVyX2FjdGl2ZScpO1xyXG4gICAgYXJyb3dbaV0uY2xhc3NMaXN0LnRvZ2dsZSgndGVhbV9fZGVzYy1hcnJvdy1pbWdfYWN0aXZlJyk7XHJcbiAgICBcclxuICAgIFxyXG5cclxuICB9KVxyXG5cclxufSAqL1xyXG5cclxufSkoKVxyXG5cclxuXHJcbiIsIi8qIGNvbnN0IG9wZW5BY2NvID0gKGl0ZW0pID0+IHtcclxuXHJcbml0ZW0uYWRkQ2xhc3MoXCJhY2NvLWl0ZW1fYWN0aXZlXCIpO1xyXG5cclxufVxyXG5cclxuXHJcblxyXG5jb25zdCBjbG9zZUFjY28gPSAobGlzdCkgPT4ge1xyXG5cclxuICBjb25zdCBsaXN0SXRlbSA9IGxpc3QuZmluZChcIi5hY2NvLWl0ZW1cIik7IFxyXG4gIGxpc3RJdGVtLnJlbW92ZUNsYXNzKFwiYWNjby1pdGVtX2FjdGl2ZVwiKTtcclxuXHJcbiAgfVxyXG5cclxuXHJcbiQoXCIuYWNjby10aXRsZS13cmFwcGVyXCIpLm9uKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICAgIGNvbnN0IGl0ZW1Db250YWluZXIgPSAkdGhpcy5jbG9zZXN0KFwiLmFjY28taXRlbVwiKTtcclxuICAgIGNvbnN0IGFjY29MaXN0ID0gaXRlbUNvbnRhaW5lci5jbG9zZXN0KFwiLmFjY28tbGlzdFwiKTtcclxuICAgIFxyXG5pZiAoaXRlbUNvbnRhaW5lci5oYXNDbGFzcyhcImFjY28taXRlbV9hY3RpdmVcIikpIHtcclxuICAgIGNsb3NlQWNjbyhhY2NvTGlzdCk7XHJcblxyXG5cclxuXHJcbn0gZWxzZSB7XHJcbiAgICBjbG9zZUFjY28oYWNjb0xpc3QpO1xyXG4gICAgb3BlbkFjY28oaXRlbUNvbnRhaW5lcik7XHJcblxyXG4gICAgfVxyXG59KSAqL1xyXG5cclxuXHJcblxyXG5cclxuXHJcbjsoZnVuY3Rpb24oKSB7XHJcblxyXG5cclxuICBjb25zdCBtYXhXaWR0aCA9IGRvY3VtZW50LmJvZHkuY2xpZW50V2lkdGg7XHJcbiAgY29uc29sZS5sb2cobWF4V2lkdGgpO1xyXG5cclxuICBcclxuICBjb25zdCBvcGVuQWNjbyA9IChpdGVtKSA9PiB7XHJcbiAgICBpdGVtLmFkZENsYXNzKFwiYWNjby1pdGVtX2FjdGl2ZVwiKTtcclxuICAgIFxyXG4gIH07XHJcbiAgXHJcbiAgY29uc3QgY2xvc2VBY2NvID0gKGxpc3QpID0+IHtcclxuICAgIGNvbnN0IGxpc3RJdGVtID0gbGlzdC5maW5kKFwiLmFjY28taXRlbVwiKTtcclxuICAgIGxpc3RJdGVtLnJlbW92ZUNsYXNzKFwiYWNjby1pdGVtX2FjdGl2ZVwiKTtcclxuICB9O1xyXG4gIFxyXG5cclxuICBsZXQgY3VycldpZHRoID0gZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aDtcclxuXHJcbiAgJCh3aW5kb3cpLm9uKCdyZXNpemUnLCBmdW5jdGlvbihlKSB7XHJcbiAgICBjdXJyV2lkdGggPSBkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoO1xyXG4gICAgY29uc29sZS5sb2coY3VycldpZHRoKTtcclxuICB9KVxyXG4gIFxyXG4gIFxyXG4gIFxyXG4gICQoXCIuYWNjby1pdGVtXCIpLm9uKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIGNvbnNvbGUubG9nKGN1cnJXaWR0aCk7XHJcbiAgICBcclxuICAgIGlmIChjdXJyV2lkdGggPiA0ODApIHtcclxuICAgICAgXHJcbiAgICAgIGlmICgkKGUudGFyZ2V0KS5oYXNDbGFzcyhcImFjY28tdGl0bGUtd3JhcHBlclwiKSB8fCAkKGUudGFyZ2V0KS5oYXNDbGFzcyhcImFjY28tdGl0bGVcIikpIHtcclxuICAgICAgICBjb25zdCAkdGhpcyA9ICQoZS50YXJnZXQpO1xyXG4gICAgICAgIGNvbnN0IGl0ZW1Db250YWluZXIgPSAkdGhpcy5jbG9zZXN0KFwiLmFjY28taXRlbVwiKTtcclxuICAgICAgICBjb25zdCBhY2NvTGlzdCA9IGl0ZW1Db250YWluZXIuY2xvc2VzdChcIi5hY2NvLWxpc3RcIik7XHJcbiAgICBcclxuICAgIFxyXG4gICAgICAgIGlmIChpdGVtQ29udGFpbmVyLmhhc0NsYXNzKFwiYWNjby1pdGVtX2FjdGl2ZVwiKSkge1xyXG4gICAgICAgICAgY2xvc2VBY2NvKGFjY29MaXN0KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgY2xvc2VBY2NvKGFjY29MaXN0KTtcclxuICAgICAgICAgIG9wZW5BY2NvKGl0ZW1Db250YWluZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgXHJcbiAgICAgIGlmICgkKGUudGFyZ2V0KS5oYXNDbGFzcyhcImNsb3NlLXhcIikgfHwgJChlLnRhcmdldCkuaGFzQ2xhc3MoXCJjbG9zZS12ZXJ0LW1lbnVcIikpIHtcclxuICAgICAgICBjb25zdCB0YXJnZXQgPSAkKGUudGFyZ2V0KTtcclxuICAgICAgICBjb25zdCBJdGVtcyA9IHRhcmdldC5jbG9zZXN0KFwiLmFjY28tbGlzdFwiKTtcclxuICAgIFxyXG4gICAgICAgIGNsb3NlQWNjbyhJdGVtcylcclxuICAgICAgfSBcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgICAgbGV0IGl0ZW1Ub0FkZCA9ICQoYDxkaXYgY2xhc3M9XCJhZGRlZC1pdGVtXCI+PC9kaXY+YCk7XHJcbiAgICAgICAgaXRlbVRvQWRkLmh0bWwoJChlLmN1cnJlbnRUYXJnZXQpLmh0bWwoKSk7XHJcblxyXG4gICAgICAgIGlmICghJCgnLmFkZGVkLWl0ZW0nKS5sZW5ndGgpIHtcclxuICAgICAgICAgICQoJy52ZXJ0aWNhbC1tZW51X19zZWN0aW9uJykuYXBwZW5kKGl0ZW1Ub0FkZCk7XHJcblxyXG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICBpdGVtVG9BZGQuYWRkQ2xhc3MoXCJhZGRlZC1pdGVtX2FjdGl2ZVwiKVxyXG4gICAgICAgICAgfSwgMTAwKTtcclxuXHJcbiAgICAgICAgICAvKiBpdGVtVG9BZGQuYWRkQ2xhc3MoXCJhZGRlZC1pdGVtX2FjdGl2ZVwiKSAqL1xyXG4gICAgICAgICAgJCgnLmFkZGVkLWl0ZW0nKS5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkge1xyXG4gICAgICAgICAgICBjb25zdCAkdGFyZ2V0ID0gJChlLnRhcmdldClcclxuICAgICAgICAgICAgaWYgKCR0YXJnZXQuaGFzQ2xhc3MoJ2Nsb3NlLXgnKSB8fCAkdGFyZ2V0Lmhhc0NsYXNzKCdhY2NvLXRpdGxlLXdyYXBwZXInKSB8fCAkdGFyZ2V0Lmhhc0NsYXNzKCdhY2NvLXRpdGxlJykpIHtcclxuXHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coZS50YXJnZXQpO1xyXG4gICAgICAgICAgICAgIGl0ZW1Ub0FkZC5yZW1vdmVDbGFzcyhcImFkZGVkLWl0ZW1fYWN0aXZlXCIpXHJcbiAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpdGVtVG9BZGQucmVtb3ZlKClcclxuICAgICAgICAgICAgICAgIH0sIDUwMCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgXHJcbiAgfSk7XHJcbiAgXHJcbn0pKClcclxuXHJcbiIsIjsoZnVuY3Rpb24oKSB7XHJcbiAgY29uc3QgcGxheWVyID0gJChcIi5wbGF5ZXItZWxlbVwiKVswXTtcclxuICBjb25zdCBwbGF5ZXJDb250YWluZXIgPSAkKFwiLnBsYXllclwiKTtcclxuICBcclxuICAkKFwiLnBsYXktc3RvcFwiKS5jbGljaygoZSkgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIFxyXG4gICAgaWYgKHBsYXllckNvbnRhaW5lci5oYXNDbGFzcyhcInBsYXllcl9wYXVzZWRcIikpIHtcclxuICAgICAgcGxheWVyQ29udGFpbmVyLnJlbW92ZUNsYXNzKFwicGxheWVyX3BhdXNlZFwiKTtcclxuICAgICAgcGxheWVyQ29udGFpbmVyLnJlbW92ZUNsYXNzKFwicGxheWVyX2FjdGl2ZVwiKTtcclxuICAgICAgcGxheWVyLnBhdXNlKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBwbGF5ZXJDb250YWluZXIuYWRkQ2xhc3MoXCJwbGF5ZXJfcGF1c2VkXCIpO1xyXG4gICAgICBwbGF5ZXIucGxheSgpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG4gIFxyXG4gICQoXCIucGxheWJhY2tfX3NsaWRlci1saW5lXCIpLmNsaWNrKChlKSA9PiB7XHJcbiAgICBjb25zdCBsaW5lID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgY29uc3QgY2xpY2tlZFBvcyA9IGUub3JpZ2luYWxFdmVudC5sYXllclg7XHJcbiAgICBjb25zdCBuZXdCdG5Qb3NQcmVjZW50ID0gKGNsaWNrZWRQb3MgLyBsaW5lLndpZHRoKCkpICogMTAwO1xyXG4gIFxyXG4gICAgJChcIi5wbGF5YmFja19fYnRuXCIpLmNzcyh7XHJcbiAgICAgIGxlZnQ6IGAke25ld0J0blBvc1ByZWNlbnR9JWAsXHJcbiAgICB9KTtcclxuICBcclxuICAgIHBsYXllci5wYXVzZSgpO1xyXG4gICAgcGxheWVyLmN1cnJlbnRUaW1lID0gcGxheWVyLmR1cmF0aW9uICogKGNsaWNrZWRQb3MgLyBsaW5lLndpZHRoKCkpO1xyXG4gICAgcGxheWVyLnBsYXkoKTtcclxuICAgIHBsYXllckNvbnRhaW5lci5hZGRDbGFzcyhcInBsYXllcl9wYXVzZWRcIik7XHJcbiAgfSk7XHJcbiAgXHJcbiAgJChwbGF5ZXIpLm9uKFwidGltZXVwZGF0ZVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICBsZXQgcGxheUJhY2tCdG4gPSAkKFwiLnBsYXliYWNrX19idG5cIik7XHJcbiAgICBsZXQgdGltZVByb2dyZXNzID0gKHBsYXllci5jdXJyZW50VGltZSAvIHBsYXllci5kdXJhdGlvbikgKiAxMDAgKyBcIiVcIjtcclxuICAgIHBsYXlCYWNrQnRuLmNzcyhcImxlZnRcIiwgdGltZVByb2dyZXNzKTtcclxuICB9KTtcclxuICBcclxuICAkKFwiLnZvbHVtZV9fc2xpZGVyLWxpbmVcIikuY2xpY2soKGUpID0+IHtcclxuICAgIGNvbnN0IHZvbHVtZUxpbmUgPSAkKGUuY3VycmVudFRhcmdldCk7XHJcbiAgICBjb25zdCB2b2x1bWVDbGlja2VkUG9zID0gZS5vcmlnaW5hbEV2ZW50LmxheWVyWDtcclxuICBcclxuICAgIGNvbnN0IHZvbEJ0blBvc1ByZWNlbnQgPSAodm9sdW1lQ2xpY2tlZFBvcyAvIHZvbHVtZUxpbmUud2lkdGgoKSkgKiAxMDA7XHJcbiAgXHJcbiAgICAkKFwiLnZvbHVtZV9fc2xpZGVyLWJ0blwiKS5jc3Moe1xyXG4gICAgICBsZWZ0OiBgJHt2b2xCdG5Qb3NQcmVjZW50fSVgLFxyXG4gICAgfSk7XHJcbiAgICBwbGF5ZXIudm9sdW1lID0gdm9sQnRuUG9zUHJlY2VudCAvIDEwMDtcclxuICBcclxuICAgIGlmIChwbGF5ZXJDb250YWluZXIuaGFzQ2xhc3MoXCJwbGF5ZXJfX3NvdW5kLW9mZlwiKSkge1xyXG4gICAgICBwbGF5ZXJDb250YWluZXIucmVtb3ZlQ2xhc3MoXCJwbGF5ZXJfX3NvdW5kLW9mZlwiKTtcclxuICAgICAgcGxheWVyLm11dGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfSk7XHJcbiAgXHJcbiAgJChcIi5wbGF5ZXItZWxlbVwiKS5vbihcInBsYXlcIiwgKGUpID0+IHtcclxuICAgIHBsYXllckNvbnRhaW5lci5hZGRDbGFzcyhcInBsYXllcl9hY3RpdmUgXCIpO1xyXG4gIH0pO1xyXG4gIFxyXG4gICQoXCIucGxheWVyLXNwbGFzaFwiKS5vbihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICBwbGF5ZXJDb250YWluZXIuYWRkQ2xhc3MoXCJwbGF5ZXJfYWN0aXZlIHBsYXllcl9wYXVzZWRcIik7XHJcbiAgICBwbGF5ZXIucGxheSgpO1xyXG4gIH0pO1xyXG4gIFxyXG4gICQoXCIudm9sdW1lX19pY29ucy13cmFwcGVyXCIpLm9uKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgIGlmIChwbGF5ZXJDb250YWluZXIuaGFzQ2xhc3MoXCJwbGF5ZXJfX3NvdW5kLW9mZlwiKSkge1xyXG4gICAgICBwbGF5ZXJDb250YWluZXIucmVtb3ZlQ2xhc3MoXCJwbGF5ZXJfX3NvdW5kLW9mZlwiKTtcclxuICAgICAgcGxheWVyLm11dGVkID0gZmFsc2U7XHJcbiAgICB9IGVsc2UgaWYgKCQoZS50YXJnZXQpLmZpbHRlcihcImNsb3NlXCIpKSB7XHJcbiAgICAgIHBsYXllckNvbnRhaW5lci5hZGRDbGFzcyhcInBsYXllcl9fc291bmQtb2ZmXCIpO1xyXG4gICAgICBwbGF5ZXIubXV0ZWQgPSB0cnVlO1xyXG4gICAgfVxyXG4gIFxyXG4gIH0pO1xyXG4gIFxyXG59KSgpXHJcblxyXG5cclxuXHJcbiJdfQ==
